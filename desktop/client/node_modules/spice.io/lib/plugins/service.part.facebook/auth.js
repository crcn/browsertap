var Facebook = require('./facebook').Facebook,
OAuth2Handler = require('psk/auth').OAuth2Handler;

//clientId     =	136899025226
//clientSecret = 89460eda6537649fdfbfc039eb5c432c

var FacebookAuthHandler = OAuth2Handler.extend({
	name:'facebook',
	'override __construct': function(appParams)
	{

		this.perms = appParams.perms;

		this._super(appParams,
		'https://graph.facebook.com'); 
	},
	'getParams': function(request)
	{
		var perms = this.perms;


		//'user_photos,user_videos,friends_photos,friends_videos,read_friendlists,user_groups,read_stream,publish_stream,user_likes'
		return {redirect_uri: 'http://' + request.host + '/authorize/facebook',scope: perms.join(',')}
	},
	'getAccountInfo': function(secret, callback)
	{

		var fb = new Facebook(secret.accessToken),
		s = this;
		
		fb.getInfo(function(data)
		{
			if(!data || data.error) return;

			callback(null,data.id,{},data.name)
		})
	}
});

exports.FacebookAuthHandler = FacebookAuthHandler;