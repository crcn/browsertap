
module.exports = function(db)
{
	var Schema = db.base.Schema,
	ObjectId = Schema.ObjectId;
	
	var Token = new Schema({
                                            
		//profile id - the link to the given token
		secret: String,
		
		//owner of the token - another profile ID which has access to the secret
		granter: String, //granter

		//the person this token is given to
		grantee: String,
		   
		//required to access any private api
		key: { type: String, index: { unique: true }},
		
		//time the token was created
		createdAt: { type: Date, default: Date.now },

		//permissions associated with given token
		scope: Array,
		
		//when will the token timeout? null = keep forever
        expiresAt: Date,
                   
		//time in seconds to keep the token alive for. -1 = forever
		ttl: Number
	}, { strict: true });                                                            
	
	return {
		Token: db.model('tokens', Token)                             
	}
}
