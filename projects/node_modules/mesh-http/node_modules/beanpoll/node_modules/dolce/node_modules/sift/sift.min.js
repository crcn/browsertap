(function(){var o=new function(){var e=this.test=function(a,b){for(var c=a.exprs,d=0,e=c.length;d<e;d++){var f=c[d];if(!f.e(f.v,b instanceof Date?b.getTime():b,b))return!1}return!0},g=this.parse=function(a,b){var c=[];if(a)if(a.constructor==Object)for(var d in a){var i=m[d]?d:"$trav",k=a[d],l=k;if(f[i])if(k instanceof Array)for(var l=[],j=k.length;j--;)l.push(g(k[j]));else l=g(a[d],d);c.push(h(i,d,l))}else c.push(h("$eq",d,a));var n={exprs:c,k:b,test:function(a){return e(n,a)}};return n},f={$and:!0,
$or:!0,$nor:!0,$trav:!0,$not:!0},m={$eq:function(a,b){return a.test(b)},$ne:function(a,b){return!a.test(b)},$lt:function(a,b){return a>b},$gt:function(a,b){return a<b},$lte:function(a,b){return a>=b},$gte:function(a,b){return a<=b},$exists:function(a,b){return a==!!b},$in:function(a,b){if(b instanceof Array)for(var c=b.length;c--;){if(a.indexOf(b[c])>-1)return!0}else return a.indexOf(b)>-1},$not:function(a,b){return!a.test(b)},$type:function(a,b,c){return c?c instanceof a||c.constructor==a:!1},$nin:function(a,
b){return!m.$in(a,b)},$mod:function(a,b){return b%a[0]==a[1]},$all:function(a,b){for(var c=a.length;c--;)if(b.indexOf(a[c])==-1)return!1;return!0},$size:function(a,b){return b?a==b.length:!1},$or:function(a,b){for(var c=a.length,d=c;c--;)if(e(a[c],b))return!0;return!d},$nor:function(a,b){for(var c=a.length,d=c;c--;)if(!e(a[c],b))return!0;return!d},$and:function(a,b){for(var c=a.length;c--;)if(!e(a[c],b))return!1;return!0},$trav:function(a,b){if(b instanceof Array){for(var c=b.length;c--;){var d=b[c];
if(d[a.k]&&e(a,d[a.k]))return!0}return!1}return b?e(a,b[a.k]):!1}},i={$eq:function(a){var b;return a instanceof RegExp?a:{test:a instanceof Function?a:function(b){return a==b}}},$ne:function(a){return i.$eq(a)}},h=function(a,b,c){c=c instanceof Date?c.getTime():c;return{k:b,v:i[a]?i[a](c):c,e:m[a]}}},p=function(e){var g=o.parse(e),f=function(e){for(var f=[],h=0,a=e.length;h<a;h++)g.test(e[h])&&f.push(e[h]);return f};f.test=g.test;f.query=e;return f},j=function(e,g){var f=p(e);return g?f(g):f};if(typeof module!=
"undefined"&&typeof module.exports!="undefined")module.exports=j;else if(typeof window!="undefined")window.sift=j})();
